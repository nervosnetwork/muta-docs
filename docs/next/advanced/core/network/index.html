<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134504127-4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-134504127-4",{})</script>
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Muta Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Muta Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu|Roboto|Source+Code+Pro">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css">

<title data-react-helmet="true">P2P Network | Docs | Muta</title>

<meta data-react-helmet="true" property="og:title" content="Muta"><meta data-react-helmet="true" name="docsearch:version" content="next"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="网络模块是为共识和交易池两个模块提供消息收发的能力。"><meta data-react-helmet="true" property="og:description" content="网络模块是为共识和交易池两个模块提供消息收发的能力。"><meta data-react-helmet="true" property="og:url" content="docs.muta.dev/docs/next/advanced/core/network">

<link data-react-helmet="true" rel="shortcut icon" href="/img/muta-logo.png">


<link rel="stylesheet" href="/styles.280b09d0.css">


<link rel="preload" href="/styles.aab16a3e.js" as="script">

<link rel="preload" href="/runtime~main.03453cf4.js" as="script">

<link rel="preload" href="/main.e4220dee.js" as="script">

<link rel="preload" href="/1.a4d1db7c.js" as="script">

<link rel="preload" href="/2.ddac714a.js" as="script">

<link rel="preload" href="/3.18f4c7ce.js" as="script">

<link rel="preload" href="/1be78505.0761eff7.js" as="script">

<link rel="preload" href="/c6c6e257.5904db9a.js" as="script">

<link rel="preload" href="/5.15d1d23d.js" as="script">

<link rel="preload" href="/17896441.8bceb62d.js" as="script">

<link rel="preload" href="/c6bcbb48.23fe56c5.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_OaSq"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/muta.svg" alt="muta"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/about/what-is-muta">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/about/what-is-muta">Master/Unreleased</a></li><li><a class="dropdown__link" href="/docs/about/what-is-muta">0.2.0-beta.4/Latest Stable</a></li></ul></div><a class="navbar__item navbar__link" href="/guides/">Guides</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/community/">Communtiy</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Translate</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/docs_zh/about/what-is-muta">中文</a></li><li><a class="dropdown__link" href="/docs/about/what-is-muta">English</a></li></ul></div><a class="navbar__item navbar__link" href="/versions">v0.2.0-beta.4</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta" class="navbar__item navbar__link header-github-link"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_34Mc moon_313u"></span></div><div class="react-toggle-track-x"><span class="toggle_34Mc sun_1Og-"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/muta.svg" alt="muta"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--sublist navbar__link--active" position="left" href="/docs/about/what-is-muta">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/about/what-is-muta">Master/Unreleased</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/about/what-is-muta">0.2.0-beta.4/Latest Stable</a></li></ul></li><li class="menu__list-item"><a class="menu__link" position="left" href="/guides/">Guides</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/blog/">Blog</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/community/">Communtiy</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist" position="right">Translate</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/docs_zh/about/what-is-muta">中文</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/about/what-is-muta">English</a></li></ul></li><li class="menu__list-item"><a class="menu__link" position="right" href="/versions">v0.2.0-beta.4</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta" class="menu__link header-github-link" position="right"></a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container_3Vzv container container--l"><div class="sidebar_dgnY"><div class="docs-sidebar sidebar_25T_"><a class="sidebarLogo_3JkW" href="/"></a><div class="menu menu--responsive menu_1e9D"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_1hKf" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><div class="title">About</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/about/what-is-muta/">What is Muta?</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/about/concepts/">Basic Concepts</a></li></ul></li><li class="menu__list-item"><div class="title">Setup</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/getting-started/">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a activeclassname="menu__link--active" class="menu__link menu__link--sublist" href="/docs/next/setup/config/">Configuration</a><ul class="menu__list"><li class="menu__list-item menu__list-item-hidden"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/config/">hidden</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/genesis-config/">Genesis Configuration</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/node-config/">Node Configuration</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/cargo-config/">Cargo configuration</a></li></ul></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/setup/deploy/">Deployment</a></li></ul></li><li class="menu__list-item"><div class="title">Development</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/dev-overview/">Overview</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-dev/">Service Dev Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a activeclassname="menu__link--active" class="menu__link menu__link--sublist" href="/docs/next/dev/service-list/service-list/">Service List</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-list/service-list/">Overview</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-list/metadata-service/">Metadata Service</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-list/asset-service/">Asset Service</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-list/auth-service/">Authorization Service</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/service-list/multi-sig-service/">Multi-signature Service</a></li></ul></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/poe-chain/">Develop a Service</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/dev/dex/">Develop a Dapp Chain</a></li></ul></li><li class="menu__list-item"><div class="title">Advanced</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/arch/">Architecture</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/transaction-block/">Transaction, Block and State</a></li><li class="menu__list-item"><a activeclassname="menu__link--active" class="menu__link menu__link--sublist" href="/docs/next/advanced/core/overlord/">Core Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/core/overlord/">Overlord</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/core/network/">P2P Network</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/core/mempool/">Mempool</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/core/storage/">Storage</a></li></ul></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/advanced/crypto/">Cryptography</a></li></ul></li><li class="menu__list-item"><div class="title">Toolchain</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/toolchain/sdk-js/">JS SDK</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/toolchain/sdk-java/">JAVA SDK</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/toolchain/muta-cli/">Muta CLI</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/toolchain/benchmark-tool/">Muta Benchmark Tool</a></li><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/toolchain/keypair/">Muta Keypair Tool</a></li></ul></li><li class="menu__list-item"><div class="title">Reference</div><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" activeclassname="menu__link--active" href="/docs/next/ref/faq/">FAQ</a></li><li class="menu__list-item"><a class="menu__link" to="https://github.com/nervosnetwork/muta/blob/master/CONTRIBUTING.md/" target="_blank" rel="noreferrer noopener" href="https://github.com/nervosnetwork/muta/blob/master/CONTRIBUTING.md/">Contributing</a></li></ul></li></ul></div></div></div><main class="main_2vyu"><div><div class="container_2j_u"><div class="leftCol_3JzO"><div class="docItemContainer_"><article><span style="vertical-align:top" class="badge badge--info">Version: next</span><header><div class="badges"></div><h1 class="docTitle_cWlf">P2P Network</h1></header><div class="markdown"><p>网络模块是为共识和交易池两个模块提供消息收发的能力。</p><p>主要提供两种消息收发方式：</p><ul><li>广播，包含特定范围节点的多播</li><li>RPC，调用上述两个模块在网络注册的服务，比如 Alice 找 Bob 索要一笔交易，就是通过这种方式</li></ul><p>注：广播信息不会被转发</p><p>网络定义了两组广播和 RPC 接口，共识和交易池可调用上述接口完成消息的发送。同时定义三个注册回调函
数的接口用于处理收到的信息，它们分别对应广播处理，RPC 请求处理以及 RPC 返回信息的数据。共识和交
易池通过注册回调函数的方式，完成自己想要的消息处理逻辑。</p><p>其他基础信息：</p><ul><li>基于 <a href="https://github.com/nervosnetwork/tentacle">tentacle</a> 实现，与 libp2p 其他实现不完全兼容</li><li>使用 TCP 连接，支持 IPv4 和 IPv6</li><li>使用 secio 方式进行机密通行，身份标识从 secp256k1 公钥派生</li><li>使用 yamux 多路复用，也即单一连接下，多种不同类型消息的混合收发</li><li>使用单一推送方式发现其他节点</li></ul><p>目前节点之间只要设置任意一个节点为 bootstrap 节点，连接后即可加入整个网络，并没有权限的限制。当
然单个节点可通过配置的方式，只允许特定的节点以及共识节点的接入。</p><p>节点之间会有相互评分机制，评分依据共识和交易池对消息的处理逻辑，给发送消息的节点打分。严重的错
误行为或评分低于 40 分都会导致节点间的连接被断开，同时一段时间内无法再次连接。</p><p>节点之间也有定期的心跳检查，确认彼此安康。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="实现细节"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#实现细节" title="Direct link to heading">#</a>实现细节</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="架构图"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#架构图" title="Direct link to heading">#</a>架构图</h3><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-undefined codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">+--------------------+----------------------+</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|      Consensus     |       Mempool        |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">+--------------------+----------------------+</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|              NetworkService(s)            |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">+--------------------+----------------------+</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|        RPC(s)      |       Gossip(s)      |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">+--------------------+----------------------+</span></div><div class="token-line" style="color:#393A34"><span class="token plain">| Peer Manager(s) - Connection(s) - Router  |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------+</span></div><div class="token-line" style="color:#393A34"><span class="token plain">|                  Peer(s)                  |</span></div><div class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------+</span></div></div></pre></div></div><p>类 actor 模型，网络组件之间通过消息传递的形式互动，下面是主要的网络
组件：</p><ul><li>Compression 压缩组件，所有共识和交易池发出的消息都采用 Snappy 进行压缩。</li><li>Connection 类似连接池的概念，负责维护所有发出和接入的连接，并通过消息事件的形式通知
节点管理组件。</li><li>Outbound 负责广播和 RPC 接口的实现，它们通过持有 Connection 服务发出消息。</li><li>PeerManager 负责节点管理，处理 Connection 发来的各种连接相关的事件消息，共识和交易池
对节点的评分事件，其他的协议对节点信息的更新事件等。</li><li>Protocols 所有网络协议的实现，包括发现协议、Ping 协议、识别协议、传输协议。
注：目前广播和 RPC 都是同过传输协议实现的。发现协议、Ping 协议、识别协议使用
tentacle 库内的代码。</li><li>Reactor 共识和交易池注册信息处理逻辑路由器，类似快递员角色，负责是将收到的快递送到目
的地地。</li><li>SelfCheck 定期发送一些自检信息</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="文件列表"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#文件列表" title="Direct link to heading">#</a>文件列表</h3><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-undefined codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">network</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── common.rs                       # 常用辅助函数</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── compression</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── snappy.rs                   # snappy 实现上述接口</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── config.rs                       # 网络配置定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── connection</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── control.rs                  # 封装 tentacle 提供的发送接口</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── keeper.rs                   # 处理 tentacle 抛出的各种连接事件</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── mod.rs                      # 连接池配置以及处理节点管理发出的连接或者断开请求</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── endpoint.rs                     # 定义共识和交易池的消息路由地址格式</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── error.rs                        # 定义网络错误</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── event.rs                        # 定义网络用到的所有事件</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── lib.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── message</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs                      # 定义网络信息格式以及序列化和反序列化</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── serde_multi.rs              # 辅助实现 serde 定义的序列化/反序列化函数，供交易池和共识使用</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── serde.rs                    # 辅助实现 serde 定义的序列化/反序列化函数，供交易池和共识使用</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── metrics.rs                      # Prometheus metrics 数据反馈</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── outbound</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── gossip.rs                   # 广播接口实现</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── rpc.rs                      # RPC 接口实现</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── peer_manager</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── addr_set.rs                 # 节点地址信息维护</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── diagnostic.rs               # 用于辅助测试时使用，暴露节点管理内部状态</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── peer.rs                     # 节点定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── retry.rs                    # 节点重试次数管理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── save_restore.rs             # 节点信息持久化，暂时只保存到文件</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── shared.rs                   # 当前连接的所有节点信息记录</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── tags.rs                     # 节点的 tag 管理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── test_manager.rs             # 节点管理单元测试</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── time.rs                     # 时间处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── trust_metric.rs             # 节点打分实现</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── protocols</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── core.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── discovery                   # 发现协议</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── addr.rs                 # 地址管理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── behaviour.rs            # 消息处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── message.rs              # 消息定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── protocol.rs             # 消息解析</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   └── substream.rs            # 抽象的消息流</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── discovery.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── identify                    # Identify 协议</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── behaviour.rs            # 消息处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── common.rs               # 通用辅助函数</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── message.rs              # 消息定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   └── protocol.rs             # 消息解析</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── identify.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── macro.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── ping                        # Ping 协议</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── behaviour.rs            # 消息处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── message.rs              # 消息定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   └── protocol.rs             # 消息解析</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── ping.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── transmitter                 # 传输协议</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── behaviour.rs            # 消息处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   ├── message.rs              # 消息定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   │   └── protocol.rs             # 消息解析</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── transmitter.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── reactor</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   ├── mod.rs                      # 共识和交易池回调逻辑处理</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── router.rs                   # 传输协议收到的消息路由</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── rpc_map.rs                      # 维护 RPC 请求的状态表</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── rpc.rs                          # 定义 RPC 信息的格式</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── selfcheck.rs                    # 自检服务</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── service.rs                      # 整个网络服务的构造</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── test</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   │   └── mock.rs                     # 单元测试需要 mock 的 tentacle 数据类型</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   ├── test.rs                         # 网络模块内部组件间交互的接口定义</span></div><div class="token-line" style="color:#393A34"><span class="token plain">   └── traits.rs</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">15 directories, 64 files</span></div></div></pre></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="配置"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#配置" title="Direct link to heading">#</a>配置</h3><table><thead><tr><th>名称</th><th>默认值</th><th>描述</th></tr></thead><tbody><tr><td>bootstraps</td><td>空</td><td>bootstraps 节点的列表，为节点的 peer id, Base58 编码 以及 <code>host:port</code> 格式的地址</td></tr><tr><td>allowlist</td><td>空</td><td>白名单节点列表，为节点的 peer id</td></tr><tr><td>allowlist_only</td><td>false</td><td>是否只连接白名单内的节点，共识节点会自动加入白名单</td></tr><tr><td>trust_interval_duration</td><td>60</td><td>节点打分系统所使用的打分周期时长，单位为秒</td></tr><tr><td>trust_max_history_duration</td><td>24 <em> 60 </em> 60 * 10 = 10 天</td><td>节点打分系统保存的历史周期时长，单位为秒</td></tr><tr><td>fatal_ban_duration</td><td>60 * 60 = 1 小时</td><td>因严重错误行为导致节点断开后，拒绝再次连接的时长，单位为秒</td></tr><tr><td>soft_ban_duration</td><td>60 * 10 = 10 分钟</td><td>因一般错误行为导致节点断开后，拒绝再次连接的时长，单位为秒</td></tr><tr><td>max_connected_peers</td><td>40</td><td>最大连接节点数量</td></tr><tr><td>inbound_conn_limit</td><td>20</td><td>连入类型的连接允许的最大数量，连出的最大数量由最大连接数减去本配置项的值</td></tr><tr><td>same_ip_conn_limit</td><td>1</td><td>同一个 IP 地址允许的最大的连接数</td></tr><tr><td>listening_address</td><td>&quot;0.0.0.0:2337&quot;</td><td>监听地址</td></tr><tr><td>rpc_timeout</td><td>10</td><td>rpc 请求超时响应时间</td></tr><tr><td>selfcheck_interval</td><td>30</td><td>网络自检间隔周期</td></tr><tr><td>send_buffer_size</td><td>24 <em> 1024 </em> 1024 = 24 MiB</td><td>发送缓存大小</td></tr><tr><td>write_timeout</td><td>10</td><td>发送超时响应时间</td></tr><tr><td>recv_buffer_size</td><td>24 <em> 1024 </em> 1024 = 24 MiB</td><td>接受缓存大小</td></tr><tr><td>max_frame_length</td><td>4 <em> 1024 </em> 1024 = 4 MiB</td><td>最大窗口大小</td></tr><tr><td>max_wait_streams</td><td>256</td><td>最大待响应的协议流数量</td></tr><tr><td>ping_interval</td><td>15</td><td>Ping 协议发送间隔时长，单位为秒</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="协议"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#协议" title="Direct link to heading">#</a>协议</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="发现协议"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#发现协议" title="Direct link to heading">#</a>发现协议</h3><p>Muta 目前使用的发现协议基于 <a href="https://github.com/nervosnetwork/tentacle/tree/master/protocols/discovery">tentacle-discovery</a> ，并有略微修改。</p><p>原协议代码只能分享 <a href="https://doc.rust-lang.org/std/net/enum.SocketAddr.html">SocketAddr</a> 定义的节点监听地址，而修改后的版本支持分享 &quot;hostname:port&quot;
可用 DNS 解析的地址。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="消息"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#消息" title="Direct link to heading">#</a>消息</h4><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-undefined codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">union DiscoveryPayload {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    GetNodes,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Nodes,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table GetNodes {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    version: Uint32,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    count: Uint32,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    listen_port: PortOpt,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table Nodes {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    announce: Bool,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    items: NodeVec,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table Node {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    addresses: BytesVec,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></pre></div></div><p>完整的消息定义请看 <a href="https://github.com/nervosnetwork/tentacle/blob/master/protocols/discovery/src/protocol.mol">protocol.mol</a></p><p>发现协议主要是两种类型的消息：</p><ul><li>GetNodes</li><li>Nodes</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="getnodes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#getnodes" title="Direct link to heading">#</a>GetNodes</h5><p>用于索要其他节点的信息，version 目前是固定值 0 不用管。count 则是索要的最大节点信息的条数，而 listen_port 则是本节点自身的监听端口，
对于连入类型的连接，其端口号为系统随机分配的端口，此时节点有必要发送 listen_port 更新自己的真实监听端口。</p><p>当前最大发送节点数量为 1000 固定值。</p><p>会导致断开的错误行为</p><ul><li>GetNodes 消息只能请求一次，重复请求会导致断开。</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor" id="nodes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#nodes" title="Direct link to heading">#</a>Nodes</h5><p>用于发送节点信息，announce 用于标识收到的节点信息为本节点主动索取的还是对方发布的。
当累计的新节点数量超过 1000 或者间隔 24 小时，会触发一次发布行为。</p><p>会导致断开的错误行为</p><ul><li>单个 PeerId 最多 3 个地址</li><li>短时间内重复推送节点信息</li><li>节点信息数量超过 1000 个</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="ping-协议"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#ping-协议" title="Direct link to heading">#</a>Ping 协议</h3><p>Muta 目前使用的 Ping 协议基于 <a href="https://github.com/nervosnetwork/tentacle/tree/master/protocols/ping">tentacle-ping</a> 。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="消息-1"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#消息-1" title="Direct link to heading">#</a>消息</h4><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-undefined codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">union PingPayload {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Ping,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    Pong,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table PingMessage {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    payload:        PingPayload,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table Ping {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    nonce: Uint32,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table Pong {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    nonce: Uint32,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></pre></div></div><p>Ping 协议本身很简单，就是重复我给你的数字，它主要的作用包括心跳检查，消息的延迟信息等。</p><p>不及时回复数字，或者回复错误的数字都会降低自身在对端节点打分系统内的分数，低于一定分数会导致连接断开。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="识别协议"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#识别协议" title="Direct link to heading">#</a>识别协议</h3><p>Muta 目前使用的识别协议同样基于 <a href="https://github.com/nervosnetwork/tentacle/tree/master/protocols/identify">tentacle-identify</a> 。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="消息-2"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#消息-2" title="Direct link to heading">#</a>消息</h4><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-undefined codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">table Address {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    bytes: Bytes,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">table IdentifyMessage {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // These are the addresses on which the peer is listening as multi-addresses.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    listen_addrs: AddressVec,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Observed each other&#x27;s ip</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    observed_addr: Address,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    // Custom message to indicate self ability, such as list protocols supported</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    identify: Bytes,</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div></div></pre></div></div><p>该协议的主要作用是帮助节点判断自己是否监听在公开的外部可直接访问的地址上，目前 Muta 要求节点必须
监听在公开可访问的地址上，暂时并无多大用处。</p><p>但错误返回信息依然会导致节点直接断开，比如</p><ul><li>发送重复的监听地址</li><li>发送重复的观测地址</li><li>一次发送超过 10 个地址</li><li>无效信息</li><li>超时</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="传输协议"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#传输协议" title="Direct link to heading">#</a>传输协议</h3><p>Muta 目前的广播和 RPC 协议都基于传输协议实现，传输协议很简单，它只是负责将收到的信息发送给上面提到的
逻辑路由器。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="消息-3"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#消息-3" title="Direct link to heading">#</a>消息</h4><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-rust codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> NetworkMessage </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[prost(map = &quot;string, bytes&quot;, tag = &quot;1&quot;)]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> headers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> HashMap</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Vec</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">u8</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[prost(string, tag = &quot;2&quot;)]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token attribute attr-name" style="color:#00a4db">#[prost(bytes, tag = &quot;3&quot;)]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Vec</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">u8</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></pre></div></div><p>其中 headers 用于保存一些通用的头部信息，比如 Jaeger 的 trace id 。url 则是信息投递的目的地址，
比如 <code>/gossip/mempool/new_txs</code>，描述的就是交易池注册用于接受新交易的地址。content 自然就是信息
本体。</p><p>传输协议会负责将信息采用 protobuf 的方式解码后，转给路由器处理。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="路由"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#路由" title="Direct link to heading">#</a>路由</h2><p>那么广播和 RPC 的消息以及处理逻辑是如何载入网络的呢？</p><p>网络模块定义了如下的注册接口</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-rust codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> register_endpoint_handler</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">M</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> handler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Box</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">dyn</span><span class="token plain"> MessageHandler</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Message </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> M</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> ProtocolResult</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        M</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MessageCodec</span><span class="token punctuation" style="color:#393A34">;</span></div></div></pre></div></div><p>可以看到接口中有 <code>end</code> endpoint 这个参数，它就是上面传输协议中提到的 url ，而 <code>handler</code> 就是被注册的消息处理逻辑。
endpoint 和 handler 会保存到路由模块的哈希表中，当传输协议将收到的信息解码后，通过 url 就自然能够找到对应的消息处理逻辑了。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="faq"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#faq" title="Direct link to heading">#</a>FAQ</h2><p>1、tentacle 和 libp2p 其他实现有哪些不兼容的地方呢？</p><p>可以看这里的文档 <a href="https://github.com/driftluo/tentacle/blob/master/docs/introduction_zh.md#%E4%B8%8D%E5%85%BC%E5%AE%B9">tentacle-introduction_zh</a></p><p>2、节点打分系统是基于什么设计的呢？</p><p>可以看这里的论文 <a href="https://dl.acm.org/citation.cfm?id=1060808">TrustGuard</a></p><p>3、为什么把广播和 RPC 都挂在同一个传输协议下面呢？</p><p>传输协议很简单，收到解码后马上就转发给路由器了。也实际测试过分多个流，并没有提高
性能。未来也许切换到 Quic 后，分流数会有更好的表现吧。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="吐哏"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#吐哏" title="Direct link to heading">#</a>吐哏</h2><p>网络模块还会继续优化调整，欢迎交流吐哏。</p></div></article></div><div class="paginator_3VDt"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/advanced/core/overlord"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Overlord</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/advanced/core/mempool"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Mempool »</h4></a></div></nav></div></div><div class="rightCol_38kP"><div class="table-of-contents tableOfContents_tVyB"><div class="section"><div class="title">Contents</div><ul class="contents"><li><a href="#实现细节" class="contents__link">实现细节</a><ul><li><a href="#架构图" class="contents__link">架构图</a></li><li><a href="#文件列表" class="contents__link">文件列表</a></li><li><a href="#配置" class="contents__link">配置</a></li></ul></li><li><a href="#协议" class="contents__link">协议</a><ul><li><a href="#发现协议" class="contents__link">发现协议</a></li><li><a href="#ping-协议" class="contents__link">Ping 协议</a></li><li><a href="#识别协议" class="contents__link">识别协议</a></li><li><a href="#传输协议" class="contents__link">传输协议</a></li></ul></li><li><a href="#路由" class="contents__link">路由</a></li><li><a href="#faq" class="contents__link">FAQ</a></li><li><a href="#吐哏" class="contents__link">吐哏</a></li></ul></div><div class="section"><div class="title">Resources</div><ul class="contents"><li><a href="https://github.com/nervosnetwork/muta-docs/edit/master/docs/advanced/core/network.md" class="contents__link" target="_blank"><i class="feather icon-edit-1"></i> Edit this page</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col col--5 footer__col"><div class="margin-bottom--md"></div><div class="margin-bottom--md"><div class="mailing-list"><form action="https://dev.us17.list-manage.com/subscribe/post?u=a7b19925733ee6bf88e045485&amp;id=d8c4724e17" method="post" class="mailing-list--form"><button class="button button--primary button--undefined" type="submit">❤ Subscribe us for Muta updates ❤ </button></form></div></div><div><a href="https://twitter.com/nervosnetwork" target="_blank"><i class="feather icon-twitter" alt="Muta&#x27;s Twitter"></i></a>    <a href="https://discord.com/invite/rN35fe8" target="_blank"><i class="feather icon-message-circle" alt="Muta&#x27;s Chat"></i></a>    <a href="https://github.com/nervosnetwork/muta" target="_blank"><i class="feather icon-github" alt="Muta&#x27;s Github Repo"></i></a></div></div><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/about/what-is-muta/">What is Muta?</a></li><li class="footer__item"><a class="footer__link-item" href="/community/#team">The Team</a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact Us</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Development</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/setup/getting-started/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dev/dev-overview/">Service Dev</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dev/dex/">Dapp Dev</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://talk.nervos.org/">Forum</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discord.com/invite/rN35fe8">Discord</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/nervosnetwork">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://nervos.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_3L_r"></a></div>Copyright © 2020 Nervos Fundation<br></div></div></footer>
</div>

<script src="/styles.aab16a3e.js"></script>

<script src="/runtime~main.03453cf4.js"></script>

<script src="/main.e4220dee.js"></script>

<script src="/1.a4d1db7c.js"></script>

<script src="/2.ddac714a.js"></script>

<script src="/3.18f4c7ce.js"></script>

<script src="/1be78505.0761eff7.js"></script>

<script src="/c6c6e257.5904db9a.js"></script>

<script src="/5.15d1d23d.js"></script>

<script src="/17896441.8bceb62d.js"></script>

<script src="/c6bcbb48.23fe56c5.js"></script>


</body>
</html>