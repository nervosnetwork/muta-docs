{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{202:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"frontMatter\",(function(){return u})),n.d(t,\"metadata\",(function(){return m})),n.d(t,\"rightToc\",(function(){return d})),n.d(t,\"default\",(function(){return b}));var a=n(1),l=n(6),i=(n(0),n(307)),r=n(309),s=n(310),o=n(312),c=n(311),u={last_modified_on:\"2020-07-13\",component_title:\"Dedupe events\",description:\"The Vector `dedupe` transform accepts and outputs `log` events, allowing you to prevent duplicate Events from being outputted by using an LRU cache.\",event_types:[\"log\"],function_category:\"filter\",issues_url:\"https://github.com/timberio/vector/issues?q=is%3Aopen+is%3Aissue+label%3A%22transform%3A+dedupe%22\",operating_systems:[\"Linux\",\"MacOS\",\"Windows\"],sidebar_label:'dedupe|[\"log\"]',source_url:\"https://github.com/timberio/vector/tree/master/src/transforms/dedupe.rs\",status:\"prod-ready\",title:\"Dedupe events Transform\",unsupported_operating_systems:[]},m={id:\"reference/transforms/dedupe\",title:\"Dedupe events Transform\",description:\"The Vector `dedupe` transform accepts and outputs `log` events, allowing you to prevent duplicate Events from being outputted by using an LRU cache.\",source:\"@site/docs/reference/transforms/dedupe.md\",permalink:\"/docs/reference/transforms/dedupe\",editUrl:\"https://github.com/nervosnetwork/muta/edit/master/website/docs/reference/transforms/dedupe.md\",sidebar_label:'dedupe|[\"log\"]'},d=[{value:\"Configuration\",id:\"configuration\",children:[{value:\"cache\",id:\"cache\",children:[]},{value:\"fields\",id:\"fields\",children:[]}]},{value:\"How It Works\",id:\"how-it-works\",children:[{value:\"Cache Behavior\",id:\"cache-behavior\",children:[]},{value:\"Complex Processing\",id:\"complex-processing\",children:[]},{value:\"Environment Variables\",id:\"environment-variables\",children:[]},{value:\"Memory Usage Details\",id:\"memory-usage-details\",children:[]},{value:\"Memory Utilization Estimation\",id:\"memory-utilization-estimation\",children:[]},{value:\"Missing Fields\",id:\"missing-fields\",children:[]}]}],p={rightToc:d};function b(e){var t=e.components,n=Object(l.a)(e,[\"components\"]);return Object(i.b)(\"wrapper\",Object(a.a)({},p,n,{components:t,mdxType:\"MDXLayout\"}),Object(i.b)(\"p\",null,\"The Vector \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"dedupe\"),\" transform\\naccepts and outputs \",Object(i.b)(\"a\",Object(a.a)({parentName:\"p\"},{href:\"/docs/about/data-model/log/\"}),Object(i.b)(\"inlineCode\",{parentName:\"a\"},\"log\")),\" events, allowing you to\\nprevent duplicate Events from being outputted by using an LRU cache.\"),Object(i.b)(\"h2\",{id:\"configuration\"},\"Configuration\"),Object(i.b)(o.a,{block:!0,defaultValue:\"common\",values:[{label:\"Common\",value:\"common\"},{label:\"Advanced\",value:\"advanced\"}],mdxType:\"Tabs\"},Object(i.b)(c.a,{value:\"common\",mdxType:\"TabItem\"},Object(i.b)(\"pre\",null,Object(i.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-toml\",metastring:'title=\"vector.toml\"',title:'\"vector.toml\"'}),'[transforms.my_transform_id]\\n  # General\\n  type = \"dedupe\" # required\\n  inputs = [\"my-source-or-transform-id\"] # required\\n\\n  # Fields\\n  fields.match = [\"timestamp\", \"host\", \"message\"] # optional, default\\n'))),Object(i.b)(c.a,{value:\"advanced\",mdxType:\"TabItem\"},Object(i.b)(\"pre\",null,Object(i.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-toml\",metastring:'title=\"vector.toml\"',title:'\"vector.toml\"'}),'[transforms.my_transform_id]\\n  # General\\n  type = \"dedupe\" # required\\n  inputs = [\"my-source-or-transform-id\"] # required\\n\\n  # Cache\\n  cache.num_events = 5000 # optional, default\\n\\n  # Fields\\n  fields.ignore = [\"field1\", \"parent.child_field\"] # optional, no default\\n  fields.match = [\"timestamp\", \"host\", \"message\"] # optional, default\\n')))),Object(i.b)(r.a,{filters:!0,mdxType:\"Fields\"},Object(i.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:[],groups:[],name:\"cache\",path:null,relevantWhen:null,required:!1,templateable:!1,type:\"table\",unit:null,warnings:[],mdxType:\"Field\"},Object(i.b)(\"h3\",{id:\"cache\"},\"cache\"),Object(i.b)(\"p\",null,\"Options controlling how we cache recent Events for future duplicate checking.\"),Object(i.b)(r.a,{filters:!1,mdxType:\"Fields\"},Object(i.b)(s.a,{common:!0,defaultValue:5e3,enumValues:null,examples:[5e3],groups:[],name:\"num_events\",path:\"cache\",relevantWhen:null,required:!1,templateable:!1,type:\"uint\",unit:null,warnings:[],mdxType:\"Field\"},Object(i.b)(\"h4\",{id:\"num_events\"},\"num_events\"),Object(i.b)(\"p\",null,\"The number of recent Events to cache and compare new incoming Events against.\")))),Object(i.b)(s.a,{common:!0,defaultValue:null,enumValues:null,examples:[],groups:[],name:\"fields\",path:null,relevantWhen:null,required:!0,templateable:!1,type:\"table\",unit:null,warnings:[],mdxType:\"Field\"},Object(i.b)(\"h3\",{id:\"fields\"},\"fields\"),Object(i.b)(\"p\",null,\"Options controlling what fields to match against\"),Object(i.b)(r.a,{filters:!1,mdxType:\"Fields\"},Object(i.b)(s.a,{common:!1,defaultValue:null,enumValues:null,examples:[[\"field1\",\"parent.child_field\"]],groups:[],name:\"ignore\",path:\"fields\",relevantWhen:null,required:!1,templateable:!1,type:\"[string]\",unit:null,warnings:[],mdxType:\"Field\"},Object(i.b)(\"h4\",{id:\"ignore\"},\"ignore\"),Object(i.b)(\"p\",null,\"The field names to ignore when deciding if an Event is a duplicate.\\nIncompatible with the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.match\"),\" option.\")),Object(i.b)(s.a,{common:!0,defaultValue:[\"timestamp\",\"host\",\"message\"],enumValues:null,examples:[[\"field1\",\"parent.child_field\"]],groups:[],name:\"match\",path:\"fields\",relevantWhen:null,required:!1,templateable:!1,type:\"[string]\",unit:null,warnings:[],mdxType:\"Field\"},Object(i.b)(\"h4\",{id:\"match\"},\"match\"),Object(i.b)(\"p\",null,\"The field names considered when deciding if an Event is a duplicate. This can\\nalso be globally set via the \",Object(i.b)(\"a\",Object(a.a)({parentName:\"p\"},{href:\"/docs/reference/global-options/#log_schema\"}),\"global \",Object(i.b)(\"inlineCode\",{parentName:\"a\"},\"log_schema\"),\"\\noptions\"),\".Incompatible with the\\n\",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.ignore\"),\" option.\"))))),Object(i.b)(\"h2\",{id:\"how-it-works\"},\"How It Works\"),Object(i.b)(\"h3\",{id:\"cache-behavior\"},\"Cache Behavior\"),Object(i.b)(\"p\",null,\"This transform is backed by an LRU cache of size \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"cache.num_events\"),\".\\nThat means that this transform will cache information in memory for the last\\n\",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"cache.num_events\"),\" Events that it has processed.  Entries will be removed from\\nthe cache in the order they were inserted.  If an Event is received that is\\nconsidered a duplicate of an Event already in the cache that will put that event\\nback to the head of the cache and reset its place in line, making it once again\\nlast entry in line to be evicted.\"),Object(i.b)(\"h3\",{id:\"complex-processing\"},\"Complex Processing\"),Object(i.b)(\"p\",null,\"If you encounter limitations with the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"dedupe\"),\"\\ntransform then we recommend using a \",Object(i.b)(\"a\",Object(a.a)({parentName:\"p\"},{href:\"https://vector.dev/components/?functions%5B%5D=program\"}),\"runtime transform\"),\".\\nThese transforms are designed for complex processing and give you the power of\\nfull programming runtime.\"),Object(i.b)(\"h3\",{id:\"environment-variables\"},\"Environment Variables\"),Object(i.b)(\"p\",null,\"Environment variables are supported through all of Vector's configuration.\\nSimply add \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"${MY_ENV_VAR}\"),\" in your Vector configuration file and the variable\\nwill be replaced before being evaluated.\"),Object(i.b)(\"p\",null,\"You can learn more in the\\n\",Object(i.b)(\"a\",Object(a.a)({parentName:\"p\"},{href:\"/docs/setup/configuration/#environment-variables\"}),\"Environment Variables\"),\" section.\"),Object(i.b)(\"h3\",{id:\"memory-usage-details\"},\"Memory Usage Details\"),Object(i.b)(\"p\",null,\"Each entry in the cache corresponds to an incoming Event and contains a copy of\\nthe 'value' data for all fields in the Event being considered for matching.\\nWhen using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.match\"),\" this will be the list of fields specified in that\\nconfig option. When using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.ignore\"),\" that will include all fields present\\nin the incoming event \",Object(i.b)(\"em\",{parentName:\"p\"},\"except\"),\" those specified in \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.ignore\"),\". Each entry\\nalso uses a single byte per field to store the type information of that field.\\nWhen using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.ignore\"),\" each cache entry additionally stores a copy of each\\nfield name being considered for matching.  When using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.match\"),\" storing\\nthe field names is not necessary.\"),Object(i.b)(\"h3\",{id:\"memory-utilization-estimation\"},\"Memory Utilization Estimation\"),Object(i.b)(\"p\",null,\"If you want to estimate the memory requirements of this transform\\nfor your dataset, you can do so with these formulas:\"),Object(i.b)(\"p\",null,\"When using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.match\"),\":\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-text\"}),\"Sum(the average size of the *data* (but not including the field name) for each field in `fields.match`) * `cache.num_events`\\n\")),Object(i.b)(\"p\",null,\"When using \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"fields.ignore\"),\":\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",Object(a.a)({parentName:\"pre\"},{className:\"language-text\"}),\"(Sum(the average size of each incoming Event) - (the average size of the field name *and* value for each field in `fields.ignore`)) * `cache.num_events`\\n\")),Object(i.b)(\"h3\",{id:\"missing-fields\"},\"Missing Fields\"),Object(i.b)(\"p\",null,\"Fields with explicit null values will always be considered different than if\\nthat field was omitted entirely.  For example, if you run this transform with\\n\",Object(i.b)(\"inlineCode\",{parentName:\"p\"},'fields.match = [\"a\"]'),', the event \"{a: null, b:5}\" will be considered different\\nthan the event \"{b:5}\".'))}b.isMDXComponent=!0},309:function(e,t,n){\"use strict\";n(12);var a=n(0),l=n.n(a),i=n(318),r=n(317),s=n(316),o=n.n(s);t.a=function({children:e,filters:t}){const[n,s]=Object(a.useState)(!1),[c,u]=Object(a.useState)(new Set),[m,d]=Object(a.useState)(!1),[p,b]=Object(a.useState)(null);let h=[];e&&(h=Array.isArray(e)?e:[e]);let f=h.some(e=>e.props.common),g=o()(h).flatMap(e=>e.props.groups).uniq().value(),v=h.some(e=>e.props.required),y=h;return n&&(y=y.filter(e=>e.props.common)),c.size>0&&(y=y.filter(e=>Array.from(c).every(t=>e.props.groups.includes(t)))),m&&(y=y.filter(e=>e.props.required)),p&&(y=y.filter(e=>e.props.name.toLowerCase().includes(p.toLowerCase()))),l.a.createElement(l.a.Fragment,null,h.length>1&&!1!==t?l.a.createElement(\"div\",{className:\"filters\"},l.a.createElement(\"div\",{className:\"search\"},l.a.createElement(\"span\",{className:\"search--result-count\"},y.length,\" items\"),l.a.createElement(\"input\",{className:\"input--text input--lg\",type:\"text\",onChange:e=>b(e.currentTarget.value),placeholder:\"\\ud83d\\udd0d Search...\"})),l.a.createElement(\"div\",{className:\"filter\"},l.a.createElement(\"div\",{className:\"filter--choices\"},l.a.createElement(i.a,{values:g,currentState:c,setState:u}),f&&l.a.createElement(\"label\",{title:\"Only show popular/common results\"},l.a.createElement(\"input\",{type:\"checkbox\",onChange:e=>s(e.currentTarget.checked),checked:n}),\"common\"),v&&l.a.createElement(\"label\",{title:\"Only show required results\"},l.a.createElement(\"input\",{type:\"checkbox\",onChange:e=>d(e.currentTarget.checked),checked:m}),\"required\")))):null,!Array.isArray(y)||y.length>0?l.a.createElement(\"ul\",{className:\"connected-list\"},y):l.a.createElement(r.a,{text:\"no components found\"}))}},310:function(e,t,n){\"use strict\";n(12);var a=n(0),l=n.n(a),i=n(306),r=n.n(i),s=(n(307),n(315));function o(e){return e.includes(\".\")?'\"'+e+'\"':e}function c(e){return\"string\"==typeof e&&e.includes(\"\\n\")?`\"\"\"\\n${e}\\n\"\"\"`:JSON.stringify(e)}function u(e,t){return(n=t)&&n.constructor===Object?\"name\"in t&&\"value\"in t?`${o(t.name)} = ${c(t.value)}`:`${o(Object.keys(t)[0])} = ${c(Object.values(t)[0])}`:e?`${o(e)} = ${c(t)}`:c(t);var n}function m({values:e}){let t=[];if(Array.isArray(e))for(var n in e){let a=e[n];t.push(l.a.createElement(\"code\",{key:a},c(a))),t.push(\" \")}else for(var a in e)t.push(l.a.createElement(\"code\",{key:a,className:\"with-info-icon\",title:e[a]},c(a))),t.push(\" \");return t}function d({name:e,path:t,values:n}){let a=\"\";return n.forEach((function(n){t&&(a+=t+\".\"),a+=u(e,n)+\"\\n\"})),l.a.createElement(\"div\",null,l.a.createElement(s.a,{className:\"language-toml\"},a))}function p({unit:e,value:t}){let n=\"\";return e&&(n=l.a.createElement(l.a.Fragment,null,\" (\",e,\")\")),l.a.createElement(l.a.Fragment,null,l.a.createElement(\"code\",null,c(t)),n)}function b({value:e}){let t=Object.keys(e)[0],n=Object.values(e)[0];return\"\"==n&&(n=null),l.a.createElement(\"span\",null,l.a.createElement(\"code\",null,l.a.createElement(\"a\",{href:\"#\"+t},t)),\" \",\"= \",l.a.createElement(\"code\",null,c(n)))}function h({defaultValue:e,enumValues:t,examples:n,groups:i,name:r,path:s,relevantWhen:o,required:c,unit:u,warnings:h}){const[f,g]=Object(a.useState)(!1);return l.a.createElement(\"ul\",{className:\"info\"},h&&h.length>0&&h.map((e,t)=>l.a.createElement(\"li\",{key:t,className:\"warning\"},l.a.createElement(\"i\",{className:\"feather icon-alert-triangle\"}),\" WARNING:\",\" \",e.text)),o&&l.a.createElement(\"li\",null,\"Only \",c?\"required\":\"relevant\",\" when:\",\" \",l.a.createElement(b,{value:o})),void 0!==e?null!==e?l.a.createElement(\"li\",null,\"Default: \",l.a.createElement(p,{unit:u,value:e})):l.a.createElement(\"li\",null,\"No default\"):null,t&&l.a.createElement(\"li\",null,\"Enum, must be one of: \",l.a.createElement(m,{values:t})),(n.length>1||n[0]!=e)&&l.a.createElement(\"li\",null,l.a.createElement(\"div\",{className:\"show-more\",onClick:()=>g(!f)},f?\"Hide examples\":\"View examples\"),f&&l.a.createElement(d,{name:r,path:s,values:n})))}t.a=function({children:e,common:t,defaultValue:n,enumValues:i,examples:s,groups:o,name:c,path:u,relevantWhen:m,required:d,templateable:p,type:b,unit:f,warnings:g}){const[v,y]=Object(a.useState)(!1);let O=e;return v&&(O=O.filter(e=>\"p\"!=e.props.originalType)),l.a.createElement(\"li\",{className:r()({\"field-required\":d,\"field-collapsed\":v}),required:d},l.a.createElement(\"div\",{className:\"badges\"},p&&l.a.createElement(\"span\",{className:\"badge badge--primary with-info-icon\",title:\"This option is dynamic and accepts the Vector template syntax\"},\"templateable\"),b&&l.a.createElement(\"span\",{className:\"badge badge--secondary\"},b,f&&l.a.createElement(l.a.Fragment,null,\" (\",f,\")\")),i&&Object.keys(i).length>0&&l.a.createElement(\"span\",{className:\"badge badge--secondary with-info-icon\",title:\"This option is an enumation and only allows specific values\"},\"enum\"),t&&l.a.createElement(\"span\",{className:\"badge badge--primary with-info-icon\",title:\"This is a popular that we recommend for getting started\"},\"common\"),d?l.a.createElement(\"span\",{className:\"badge badge--danger\"},\"required\",m&&\"*\"):l.a.createElement(\"span\",{className:\"badge badge--secondary\"},\"optional\")),O,!v&&\"table\"!=b&&l.a.createElement(h,{defaultValue:n,enumValues:i,examples:s,groups:o,name:c,path:u,relevantWhen:m,required:d,unit:f,warnings:g}))}}}]);","extractedComments":[]}