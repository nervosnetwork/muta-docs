{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{122:function(e,t,r){\"use strict\";r.r(t),r.d(t,\"frontMatter\",(function(){return l})),r.d(t,\"metadata\",(function(){return o})),r.d(t,\"rightToc\",(function(){return i})),r.d(t,\"default\",(function(){return b}));var n=r(1),a=r(6),c=(r(0),r(206)),l={title:\"Service Development Guide\"},o={id:\"dev/service-dev\",title:\"Service Development Guide\",description:\"## \\u6982\\u5ff5\",source:\"@site/docs/dev/service-dev.md\",permalink:\"/new-docs/docs/dev/service-dev\",editUrl:\"https://github.com/nervosnetwork/muta/edit/master/website/docs/dev/service-dev.md\",sidebar:\"docs\",previous:{title:\"Development Overview\",permalink:\"/new-docs/docs/dev/dev-overview\"},next:{title:\"Service Demo\",permalink:\"/new-docs/docs/dev/service-eg\"}},i=[{value:\"\\u6982\\u5ff5\",id:\"\\u6982\\u5ff5\",children:[]},{value:\"\\u5f00\\u53d1\\u8303\\u5f0f\",id:\"\\u5f00\\u53d1\\u8303\\u5f0f\",children:[]},{value:\"\\u72b6\\u6001\\u5b58\\u50a8\",id:\"\\u72b6\\u6001\\u5b58\\u50a8\",children:[]},{value:\"\\u63a5\\u53e3\\u65b9\\u6cd5\",id:\"\\u63a5\\u53e3\\u65b9\\u6cd5\",children:[]},{value:\"\\u8fd4\\u56de\\u503c\\u548c\\u9519\\u8bef\\u5904\\u7406\",id:\"\\u8fd4\\u56de\\u503c\\u548c\\u9519\\u8bef\\u5904\\u7406\",children:[]},{value:\"\\u521b\\u4e16\\u914d\\u7f6e\",id:\"\\u521b\\u4e16\\u914d\\u7f6e\",children:[]},{value:\"\\u8d44\\u6e90\\u6d88\\u8017\\u7edf\\u8ba1\\uff1acycle\",id:\"\\u8d44\\u6e90\\u6d88\\u8017\\u7edf\\u8ba1\\uff1acycle\",children:[]},{value:\"\\u4e8b\\u4ef6\",id:\"\\u4e8b\\u4ef6\",children:[]},{value:\"ServiceContext \\u4e2d\\u7684\\u5176\\u4ed6\\u65b9\\u6cd5\",id:\"servicecontext-\\u4e2d\\u7684\\u5176\\u4ed6\\u65b9\\u6cd5\",children:[]},{value:\"Service \\u8c03\\u7528\",id:\"service-\\u8c03\\u7528\",children:[]},{value:\"Hook\",id:\"hook\",children:[]},{value:\"\\u5e8f\\u5217\\u5316\",id:\"\\u5e8f\\u5217\\u5316\",children:[{value:\"Json\",id:\"json\",children:[]},{value:\"RLP\",id:\"rlp\",children:[]}]},{value:\"\\u6784\\u9020\\u65b9\\u6cd5\",id:\"\\u6784\\u9020\\u65b9\\u6cd5\",children:[]},{value:\"Service \\u793a\\u4f8b\",id:\"service-\\u793a\\u4f8b\",children:[]},{value:\"\\u4e0b\\u4e00\\u7ad9\",id:\"\\u4e0b\\u4e00\\u7ad9\",children:[]}],s={rightToc:i};function b(e){var t=e.components,r=Object(a.a)(e,[\"components\"]);return Object(c.b)(\"wrapper\",Object(n.a)({},s,r,{components:t,mdxType:\"MDXLayout\"}),Object(c.b)(\"h2\",{id:\"\\u6982\\u5ff5\"},\"\\u6982\\u5ff5\"),Object(c.b)(\"p\",null,\"\\u533a\\u5757\\u94fe\\u4f5c\\u4e3a\\u4e00\\u79cd\\u65b0\\u7684\\u5206\\u5e03\\u5f0f\\u5e94\\u7528\\uff0c\\u53ef\\u4ee5\\u7b80\\u5355\\u7684\\u7406\\u89e3\\u6210\\u4e00\\u4e2a\\u526f\\u672c\\u72b6\\u6001\\u673a\\uff0c\\u540c\\u65f6\\u4f7f\\u7528\\u5bc6\\u7801\\u5b66\\u505a\\u5230\\u5e94\\u7528\\u6570\\u636e\\u7684\\u53ef\\u9a8c\\u8bc1\\u548c\\u9632\\u7be1\\u6539\\u3002\\u4e00\\u65b9\\u9762\\uff0c\\u591a\\u4e2a\\u526f\\u672c\\u7684\\u901a\\u4fe1\\u548c\\u4e00\\u81f4\\u6027\\uff0c\\u7531 P2P \\u7f51\\u7edc\\u3001\\u4ea4\\u6613\\u6c60\\u548c\\u5171\\u8bc6\\u7ec4\\u4ef6\\u7b49\\u5171\\u540c\\u5b8c\\u6210\\uff0c\\u8fd9\\u4e9b\\u7ec4\\u4ef6\\u4e5f\\u662f\\u533a\\u5757\\u94fe\\u67b6\\u6784\\u4e2d\\u7684\\u5e95\\u5c42\\u6a21\\u5757\\uff0c\\u4e00\\u822c\\u5f88\\u5c11\\u53d8\\u52a8\\uff0c\\u6240\\u4ee5\\u53ef\\u4ee5\\u56fa\\u5316\\u5230\\u6846\\u67b6\\u4e2d\\u76f4\\u63a5\\u63d0\\u4f9b\\u7ed9\\u5f00\\u53d1\\u8005\\u4f7f\\u7528\\u3002\\u53e6\\u4e00\\u65b9\\u9762\\uff0c\\u72b6\\u6001\\u673a\\u90e8\\u5206\\u5f80\\u5f80\\u4e0e\\u94fe\\u7684\\u5177\\u4f53\\u9700\\u6c42\\u548c\\u4e1a\\u52a1\\u76f8\\u5173\\uff0c\\u9700\\u8981\\u7531\\u5f00\\u53d1\\u8005\\u8fdb\\u884c\\u81ea\\u5b9a\\u4e49\\uff0c\\u6846\\u67b6\\u63d0\\u4f9b SDK \\u6765\\u8ba9\\u51cf\\u8f7b\\u8fd9\\u90e8\\u5206\\u5de5\\u4f5c\\u7684\\u65f6\\u95f4\\u6210\\u672c\\u548c\\u6280\\u672f\\u590d\\u6742\\u5ea6\\u3002\"),Object(c.b)(\"p\",null,\"Muta \\u6846\\u67b6\\u5c06\\u7528\\u6237\\u81ea\\u5b9a\\u4e49\\u90e8\\u5206\\u62bd\\u8c61\\u6210\\u4e00\\u4e2a Service\\uff0c\\u540c\\u65f6\\u63d0\\u4f9b \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceSDK\"),\" \\u8ba9 Service \\u5f00\\u53d1\\u53d8\\u5f97\\u7b80\\u5355\\u548c\\u9ad8\\u6548\\u3002\\u6bcf\\u4e2a Service \\u5b8c\\u6210\\u4e00\\u4e2a\\u76f8\\u5bf9\\u72ec\\u7acb\\u7684\\u529f\\u80fd\\uff0c\\u5355\\u72ec\\u7ef4\\u62a4\\u81ea\\u5df1\\u7684\\u5b58\\u50a8\\u548c\\u64cd\\u4f5c\\u63a5\\u53e3\\uff0c\\u7c7b\\u4f3c\\u4e00\\u4e2a\\u8fd0\\u884c\\u5728\\u6c99\\u76d2\\u91cc\\u7684\\u5c0f\\u578b\\u72b6\\u6001\\u673a\\u3002\\u5f00\\u53d1\\u8005\\u53ef\\u4ee5\\u4f7f\\u7528 Service \\u5f00\\u53d1\\u94fe\\u7684\\u6cbb\\u7406\\u6a21\\u5757\\u3001\\u4e1a\\u52a1\\u903b\\u8f91\\uff0c\\u751a\\u81f3\\u662f\\u5c06\\u865a\\u62df\\u673a\\u63a5\\u5165\\u533a\\u5757\\u94fe\\u3002\\u9664\\u4e86\\u5f00\\u53d1\\u81ea\\u5df1\\u7684 Service\\uff0c\\u4f60\\u4e5f\\u53ef\\u4ee5\\u590d\\u7528\\u4ed6\\u4eba\\u5df2\\u7ecf\\u5f00\\u53d1\\u597d\\u7684 Service\\uff0c\\u672a\\u6765 Muta \\u6846\\u67b6\\u4f1a\\u63d0\\u4f9b\\u8bb8\\u591a\\u5e38\\u89c1\\u529f\\u80fd\\u7684 Service\\uff0c\\u5982 Asset\\u3001Risc-V \\u865a\\u62df\\u673a\\u3001DPoS\\u3001\\u591a\\u7b7e\\u6cbb\\u7406\\u7b49\\u7b49\\u3002Service \\u4e4b\\u95f4\\u53ef\\u4ee5\\u4e92\\u76f8\\u8c03\\u7528\\uff0c\\u8fd9\\u4e9b Service \\u5171\\u540c\\u7ec4\\u6210\\u4e86\\u94fe\\u7684\\u72b6\\u6001\\u673a\\u90e8\\u5206\\uff0c\\u901a\\u8fc7\\u6846\\u67b6\\u63a5\\u53e3\\u5c06\\u72b6\\u6001\\u673a\\u63a5\\u5165\\u533a\\u5757\\u94fe\\u5e95\\u5c42\\u7ec4\\u4ef6\\uff0c\\u4e00\\u6761\\u4e13\\u5c5e\\u4f60\\u7684\\u5168\\u65b0\\u94fe\\u5c31\\u5f00\\u53d1\\u5b8c\\u6210\\u5566\\u3002\"),Object(c.b)(\"p\",null,\"\\u6362\\u53e5\\u8bdd\\u8bf4\\uff0c\\u4f7f\\u7528 Muta \\u6846\\u67b6\\u5f00\\u53d1\\u4f60\\u81ea\\u5df1\\u7684\\u533a\\u5757\\u94fe\\u53ea\\u9700 3 \\u6b65\\uff1a\"),Object(c.b)(\"ol\",null,Object(c.b)(\"li\",{parentName:\"ol\"},\"\\u601d\\u8003\\u81ea\\u5df1\\u94fe\\u7684\\u4e13\\u5c5e\\u9700\\u6c42\\uff0c\\u786e\\u5b9a\\u9700\\u8981\\u54ea\\u4e9b Service\"),Object(c.b)(\"li\",{parentName:\"ol\"},\"\\u5982\\u679c\\u9700\\u8981\\u7684 Service \\u6709\\u73b0\\u6210\\u7684\\uff0c\\u53ef\\u4ee5\\u76f4\\u63a5\\u590d\\u7528\\uff1b\\u5982\\u679c\\u6ca1\\u6709\\uff0c\\u53ef\\u4ee5\\u81ea\\u5df1\\u5f00\\u53d1\"),Object(c.b)(\"li\",{parentName:\"ol\"},\"\\u5c06\\u8fd9\\u4e9b Service \\u63a5\\u5165\\u6846\\u67b6\\uff0c\\u7f16\\u8bd1\\u8fd0\\u884c\\uff01\")),Object(c.b)(\"p\",null,\"\\u8fd9\\u7bc7\\u6587\\u7ae0\\u4e3b\\u8981\\u4ecb\\u7ecd Service \\u7684\\u7ec4\\u6210\\u548c\\u5f00\\u53d1\\u6307\\u5357\\u3002\\u5728\\u719f\\u6089 Service \\u4e4b\\u540e\\uff0c\\u53ef\\u4ee5\\u9605\\u8bfb \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"/new-docs/docs/dev/dex\"}),\"\\u5f00\\u53d1\\u4e00\\u6761 Dex \\u4e13\\u6709\\u94fe\"),\"\\uff0c\\u5b66\\u4e60\\u5982\\u4f55\\u4f7f\\u7528 Muta \\u6846\\u67b6\\u4ece\\u96f6\\u5f00\\u53d1\\u4e00\\u6761\\u533a\\u5757\\u94fe\\u3002\"),Object(c.b)(\"h2\",{id:\"\\u5f00\\u53d1\\u8303\\u5f0f\"},\"\\u5f00\\u53d1\\u8303\\u5f0f\"),Object(c.b)(\"p\",null,\"\\u5728\\u8bbe\\u8ba1 Service \\u65f6\\uff0c\\u6211\\u4eec\\u5e0c\\u671b\\u964d\\u4f4e\\u5f00\\u53d1\\u8005\\u7684\\u5f00\\u53d1\\u95e8\\u69db\\uff0c\\u8ba9\\u66f4\\u591a\\u5bf9\\u533a\\u5757\\u94fe\\u4e0d\\u90a3\\u4e48\\u719f\\u6089\\u7684\\u5f00\\u53d1\\u8005\\u4e5f\\u53ef\\u4ee5\\u5feb\\u901f\\u4e0a\\u624b\\uff0c\\u5f00\\u53d1\\u81ea\\u5df1\\u7684\\u533a\\u5757\\u94fe\\u3002\\u5728\\u5f00\\u53d1\\u4f53\\u9a8c\\u4e0a\\uff0c\\u6211\\u4eec\\u5e0c\\u671b\\u5411\\u5f00\\u53d1\\u5408\\u7ea6\\u7684\\u4f53\\u9a8c\\u9760\\u62e2\\uff0c\\u5982\\u679c\\u4f60\\u5df2\\u7ecf\\u5b66\\u4f1a\\u4e86\\u5982\\u4f55\\u5f00\\u53d1\\u5408\\u7ea6\\uff0c\\u90a3\\u4e48\\u606d\\u559c\\u4f60\\uff0c\\u4f60\\u4e5f\\u5df2\\u7ecf\\u5b66\\u4f1a\\u4e86\\u5982\\u4f55\\u5f00\\u53d1 Service\\u3002\\u5728\\u5f00\\u53d1\\u8303\\u5f0f\\u4e0a\\uff0c\\u6211\\u4eec\\u628a Service \\u62bd\\u8c61\\u6210\\u4e00\\u4e2a\\u5c0f\\u578b\\u72b6\\u6001\\u673a\\uff0cService \\u5305\\u542b\\u666e\\u901a\\u72b6\\u6001\\u673a\\u6240\\u62e5\\u6709\\u7684\\u7ec4\\u4ef6\\uff1a\"),Object(c.b)(\"ul\",null,Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u72b6\\u6001\\uff08\\u5b58\\u50a8\\uff09\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u8f93\\u5165\\uff08\\u63a5\\u53e3\\uff09\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u51fd\\u6570\\uff08\\u903b\\u8f91\\uff09\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u8f93\\u51fa\\uff08\\u8fd4\\u56de\\u503c\\uff09\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u5f02\\u5e38\\u548c\\u9519\\u8bef\\u5904\\u7406\")),Object(c.b)(\"p\",null,\"\\u540c\\u65f6\\u4e5f\\u5305\\u542b\\u533a\\u5757\\u94fe\\u7279\\u6709\\u7684\\u4e00\\u4e9b\\u7ec4\\u4ef6\\uff1a\"),Object(c.b)(\"ul\",null,Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u521b\\u4e16\\u5757\\u914d\\u7f6e\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u4e8b\\u4ef6\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u8d44\\u6e90\\u6d88\\u8017\\u7edf\\u8ba1\\uff08Cycle\\uff09\"),Object(c.b)(\"li\",{parentName:\"ul\"},\"\\u4e0e\\u533a\\u5757\\u94fe\\u76f8\\u5173\\u7684\\u94a9\\u5b50\\u51fd\\u6570\\uff0c\",Object(c.b)(\"inlineCode\",{parentName:\"li\"},\"before_block\"),\" \\u5728\\u4e00\\u4e2a\\u533a\\u5757\\u6267\\u884c\\u524d\\u8c03\\u7528 Service \\u7684\\u51fd\\u6570\\uff0c\",Object(c.b)(\"inlineCode\",{parentName:\"li\"},\"after_block\"),\" \\u5728\\u4e00\\u4e2a\\u533a\\u5757\\u6267\\u884c\\u540e\\u8c03\\u7528 Service \\u7684\\u51fd\\u6570\")),Object(c.b)(\"p\",null,\"\\u63a5\\u4e0b\\u6765\\u6211\\u4eec\\u5206\\u522b\\u4ecb\\u7ecd\\u6bcf\\u4e2a\\u7ec4\\u4ef6\\u3002\"),Object(c.b)(\"h2\",{id:\"\\u72b6\\u6001\\u5b58\\u50a8\"},\"\\u72b6\\u6001\\u5b58\\u50a8\"),Object(c.b)(\"p\",null,\"\\u533a\\u522b\\u4e8e\\u666e\\u901a\\u7a0b\\u5e8f\\u7684\\u5b58\\u50a8\\uff0c\\u533a\\u5757\\u94fe\\u7684\\u5b58\\u50a8\\u9700\\u8981\\u4f7f\\u7528\\u5bc6\\u7801\\u5b66\\u4fdd\\u8bc1\\u6570\\u636e\\u7684\\u53ef\\u9a8c\\u8bc1\\u548c\\u9632\\u7be1\\u6539\\u3002\",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceSDK\"),\" \\u63d0\\u4f9b\\u4e86\\u4e00\\u4e9b\\u6570\\u636e\\u7c7b\\u578b\\u548c\\u63a5\\u53e3\\uff0c\\u8ba9\\u5f00\\u53d1\\u8005\\u65e0\\u9700\\u5173\\u5fc3\\u5bc6\\u7801\\u5b66\\u76f8\\u5173\\u7684\\u90e8\\u5206\\uff0c\\u53ef\\u4ee5\\u50cf\\u5f00\\u53d1\\u666e\\u901a\\u7a0b\\u5e8f\\u4e00\\u6837\\u5b8c\\u6210\\u72b6\\u6001\\u7684\\u5b58\\u50a8\\u3002\"),Object(c.b)(\"p\",null,Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceSDK\"),\" \\u63d0\\u4f9b\\u4e86\\u4e24\\u7c7b\\u5b58\\u50a8\\u63a5\\u53e3\\uff0c\\u4e00\\u7c7b\\u662f\\u83b7\\u5f97\\u5e38\\u89c1\\u6570\\u636e\\u7c7b\\u578b map\\u3001array\\u3001uint64\\u3001String\\u3001Bool \\u7684\\u63a5\\u53e3\\uff0c\\u4f7f\\u7528\\u8fd9\\u4e9b\\u6570\\u636e\\u7c7b\\u578b\\u7684\\u6570\\u636e\\u4f1a\\u81ea\\u52a8\\u5b58\\u5165\\u533a\\u5757\\u94fe\\u7684\\u4e16\\u754c\\u72b6\\u6001\\u4e2d\\u3002\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"pub trait ServiceSDK {\\n    // Alloc or recover a `Map` by` var_name`\\n    fn alloc_or_recover_map<Key: 'static + FixedCodec + PartialEq, Val: 'static + FixedCodec>(\\n        &mut self,\\n        var_name: &str,\\n    ) -> ProtocolResult<Box<dyn StoreMap<Key, Val>>>;\\n\\n    // Alloc or recover a `Array` by` var_name`\\n    fn alloc_or_recover_array<Elm: 'static + FixedCodec>(\\n        &mut self,\\n        var_name: &str,\\n    ) -> ProtocolResult<Box<dyn StoreArray<Elm>>>;\\n\\n    // Alloc or recover a `Uint64` by` var_name`\\n    fn alloc_or_recover_uint64(&mut self, var_name: &str) -> ProtocolResult<Box<dyn StoreUint64>>;\\n\\n    // Alloc or recover a `String` by` var_name`\\n    fn alloc_or_recover_string(&mut self, var_name: &str) -> ProtocolResult<Box<dyn StoreString>>;\\n\\n    // Alloc or recover a `Bool` by` var_name`\\n    fn alloc_or_recover_bool(&mut self, var_name: &str) -> ProtocolResult<Box<dyn StoreBool>>;\\n\\n... ...\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u5982\\u679c\\u8fd9\\u4e9b\\u6570\\u636e\\u7c7b\\u578b\\u4e0d\\u80fd\\u6ee1\\u8db3\\u4f60\\u7684\\u9700\\u6c42\\uff0c\\u8fd8\\u6709\\u4e00\\u7c7b key-value \\u63a5\\u53e3\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"pub trait ServiceSDK {\\n    // Get a value from the service state by key\\n    fn get_value<Key: FixedCodec, Ret: FixedCodec>(&self, key: &Key)\\n        -> ProtocolResult<Option<Ret>>;\\n\\n    // Set a value to the service state by key\\n    fn set_value<Key: FixedCodec, Val: FixedCodec>(\\n        &mut self,\\n        key: Key,\\n        val: Val,\\n    ) -> ProtocolResult<()>;\\n\\n    // Get a value from the specified address by key\\n    fn get_account_value<Key: FixedCodec, Ret: FixedCodec>(\\n        &self,\\n        address: &Address,\\n        key: &Key,\\n    ) -> ProtocolResult<Option<Ret>>;\\n\\n    // Insert a pair of key / value to the specified address\\n    fn set_account_value<Key: FixedCodec, Val: FixedCodec>(\\n        &mut self,\\n        address: &Address,\\n        key: Key,\\n        val: Val,\\n    ) -> ProtocolResult<()>;\\n\\n... ...\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u4f7f\\u7528\\u8fd9\\u7c7b\\u63a5\\u53e3\\u7684\\u6570\\u636e\\u4e5f\\u4f1a\\u81ea\\u52a8\\u5b58\\u50a8\\u5728\\u4e16\\u754c\\u72b6\\u6001\\u4e2d\\u3002\"),Object(c.b)(\"p\",null,\"\\u4f60\\u9700\\u8981\\u4f7f\\u7528\\u7ed3\\u6784\\u4f53\\u6765\\u5c01\\u88c5 Service\\uff0c\\u4ee5 Dex Service \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"// A dex service\\npub struct DexService<SDK: ServiceSDK> {\\n    sdk: SDK,\\n    trades: Box<dyn StoreMap<Hash, Trade>>,\\n    buy_orders: Box<dyn StoreMap<Hash, Order>>,\\n    sell_orders: Box<dyn StoreMap<Hash, Order>>,\\n    history_orders: Box<dyn StoreMap<Hash, Order>>,\\n    validity: Box<dyn StoreUint64>,\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u6b64\\u5916\\uff0cService \\u7684\\u7ed3\\u6784\\u4f53\\u4e2d\\u9700\\u8981\\u5305\\u542b\\u5b9e\\u73b0 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceSDK\"),\" trait \\u7684\\u6570\\u636e\\u7c7b\\u578b\\uff0c\\u901a\\u8fc7\\u8be5\\u7c7b\\u578b\\u83b7\\u5f97 ServiceSDK \\u63d0\\u4f9b\\u7684\\u80fd\\u529b\\u3002\"),Object(c.b)(\"h2\",{id:\"\\u63a5\\u53e3\\u65b9\\u6cd5\"},\"\\u63a5\\u53e3\\u65b9\\u6cd5\"),Object(c.b)(\"p\",null,\"Service \\u901a\\u8fc7\\u8fc7\\u7a0b\\u5b8f\\u6807\\u8bb0\\u65b9\\u6cd5\\uff0c\\u6765\\u63d0\\u4f9b\\u94fe\\u5916\\u548c\\u5176\\u4ed6 Service \\u53ef\\u4ee5\\u8c03\\u7528\\u7684\\u63a5\\u53e3\\uff0c\\u4ee5 Dex Service \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"#[service]\\nimpl<SDK: 'static + ServiceSDK> DexService<SDK> {\\n    #[cycles(210_00)]\\n    #[write]\\n    fn add_trade(&mut self, ctx: ServiceContext, payload: AddTradePayload) -> ProtocolResult<()>;\\n\\n    #[read]\\n    fn get_trades(&self, _ctx: ServiceContext) -> ProtocolResult<GetTradesResponse>;\\n\\n... ...\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u7ed9 Service \\u7ed3\\u6784\\u4f53\\u7ed1\\u5b9a\\u65b9\\u6cd5\\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"impl\"),\" \\u5757\\u4e2d\\uff0c\\u9700\\u8981\\u6807\\u8bb0 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[service]\"),\" \\u8fc7\\u7a0b\\u5b8f\\uff0c\\u8be5\\u8fc7\\u7a0b\\u5b8f\\u4f1a\\u7ed9 Service \\u81ea\\u52a8\\u5b9e\\u73b0 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"Service\"),\" trait\\uff0c\\u6846\\u67b6\\u901a\\u8fc7\\u8be5 trait \\u548c Service \\u4ea4\\u4e92\\u3002\"),Object(c.b)(\"p\",null,\"Dex Service \\u4e2d\\u5b9a\\u4e49\\u4e86\\u589e\\u52a0\\u4ea4\\u6613\\u5bf9\\u548c\\u8bfb\\u53d6\\u4ea4\\u6613\\u5bf9\\u4e24\\u4e2a\\u63a5\\u53e3\\u65b9\\u6cd5\\uff0c\\u6807\\u8bb0\\u4e86 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[write]\"),\" \\u7684\\u4e3a\\u5199\\u65b9\\u6cd5\\uff0c\\u8be5\\u65b9\\u6cd5\\u53ef\\u4ee5\\u6539\\u53d8 Service \\u72b6\\u6001\\uff1b\\u6807\\u8bb0\\u4e86 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[read]\"),\" \\u7684\\u4e3a\\u8bfb\\u65b9\\u6cd5\\uff0c\\u8be5\\u65b9\\u6cd5\\u4e0d\\u80fd\\u6539\\u53d8 Service \\u72b6\\u6001\\uff1b\\u65b9\\u6cd5\\u7684\\u7b2c\\u4e8c\\u4e2a\\u53c2\\u6570\\u5fc5\\u987b\\u4e3a \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceContext\"),\" \\u7c7b\\u578b\\uff0c\\u8be5\\u7c7b\\u578b\\u8d1f\\u8d23\\u7ba1\\u7406\\u4ea4\\u6613\\u6267\\u884c\\u7684\\u4e0a\\u4e0b\\u6587\\uff1b\\u65b9\\u6cd5\\u7684\\u7b2c\\u4e09\\u4e2a\\u53c2\\u6570\\u662f\\u53ef\\u9009\\u7684\\uff0c\\u5b9a\\u4e49\\u63a5\\u53e3\\u7684\\u8f93\\u5165\\u53c2\\u6570\\uff0c\\u540c\\u65f6\\u9700\\u8981\\u4e3a\\u8be5\\u7c7b\\u578b\\u5b9e\\u73b0\\u5e8f\\u5217\\u5316 trait\\uff0c\\u76ee\\u524d\\u6846\\u67b6\\u4f7f\\u7528\\u7684\\u662f json \\u5e8f\\u5217\\u5316\\u65b9\\u6848\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"#[derive(Deserialize, Serialize, Clone, Debug, PartialEq, Eq)]\\npub struct AddTradePayload {\\n    pub base_asset: Hash,\\n    pub counter_party: Hash,\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u63a5\\u53e3\\u65b9\\u6cd5\\u6700\\u591a\\u53ea\\u80fd\\u6709\\u8fd9 3 \\u4e2a\\u53c2\\u6570\\u3002\"),Object(c.b)(\"h2\",{id:\"\\u8fd4\\u56de\\u503c\\u548c\\u9519\\u8bef\\u5904\\u7406\"},\"\\u8fd4\\u56de\\u503c\\u548c\\u9519\\u8bef\\u5904\\u7406\"),Object(c.b)(\"p\",null,\"\\u63a5\\u53e3\\u65b9\\u6cd5\\u7684\\u8fd4\\u56de\\u503c\\u7edf\\u4e00\\u4e3a \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ProtocolResult<T>\"),\" \\u7c7b\\u578b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),'pub type ProtocolResult<T> = Result<T, ProtocolError>;\\n\\n#[derive(Debug, Constructor, Display)]\\n#[display(fmt = \"[ProtocolError] Kind: {:?} Error: {:?}\", kind, error)]\\npub struct ProtocolError {\\n    kind:  ProtocolErrorKind,\\n    error: Box<dyn Error + Send>,\\n}\\n\\nimpl From<ProtocolError> for Box<dyn Error + Send> {\\n    fn from(error: ProtocolError) -> Self {\\n        Box::new(error) as Box<dyn Error + Send>\\n    }\\n}\\n\\nimpl Error for ProtocolError {}\\n')),Object(c.b)(\"p\",null,\"\\u6bcf\\u4e2a Service \\u5b9a\\u4e49\\u81ea\\u5df1\\u7684\\u9519\\u8bef\\u7c7b\\u578b\\uff0c\\u5e76\\u5c06\\u8be5\\u7c7b\\u578b\\u8f6c\\u6362\\u4e3a \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ProtocolError\"),\" \\u4f9b\\u6846\\u67b6\\u7edf\\u4e00\\u5904\\u7406\\uff0c\\u4ee5 Dex Service \\u4e3a\\u4f8b\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),'#[derive(Debug, Display, From)]\\npub enum DexError {\\n    #[display(fmt = \"Parsing payload to json failed {:?}\", _0)]\\n    JsonParse(serde_json::Error),\\n\\n    IllegalTrade,\\n\\n    TradeExisted,\\n\\n    TradeNotExisted,\\n\\n    OrderOverdue,\\n\\n    OrderNotExisted,\\n}\\n\\nimpl std::error::Error for DexError {}\\n\\nimpl From<DexError> for ProtocolError {\\n    fn from(err: DexError) -> ProtocolError {\\n        ProtocolError::new(ProtocolErrorKind::Service, Box::new(err))\\n    }\\n}\\n')),Object(c.b)(\"h2\",{id:\"\\u521b\\u4e16\\u914d\\u7f6e\"},\"\\u521b\\u4e16\\u914d\\u7f6e\"),Object(c.b)(\"p\",null,\"\\u5982\\u679c\\u521b\\u4e16\\u5757\\u7684\\u4e16\\u754c\\u72b6\\u6001\\u9700\\u8981\\u5305\\u542b Service \\u7684\\u521d\\u59cb\\u72b6\\u6001\\uff0c\\u53ef\\u4ee5\\u5728 Service \\u4e2d\\u901a\\u8fc7\\u8fc7\\u7a0b\\u5b8f\",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[genesis]\"),\" \\u6807\\u6ce8\\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn init_genesis\"),\" \\u65b9\\u6cd5\\u6765\\u5b8c\\u6210\\u3002\\u6846\\u67b6\\u5728\\u521b\\u5efa\\u521b\\u4e16\\u5757\\u65f6\\uff0c\\u4f1a\\u8c03\\u7528 Service \\u4e2d\\u6807\\u6ce8\\u4e86 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[genesis]\"),\" \\u7684\\u65b9\\u6cd5\\u6765\\u5b8c\\u6210\\u521d\\u59cb\\u5316\\uff0c\\u8be5\\u51fd\\u6570\\u6700\\u591a\\u53ea\\u6709\\u4e00\\u4e2a\\u3002\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"#[genesis]\\nfn init_genesis(&mut self, payload: GenesisPayload) -> ProtocolResult<()> {\\n    self.validity.set(payload.order_validity)\\n}\\n\")),Object(c.b)(\"h2\",{id:\"\\u8d44\\u6e90\\u6d88\\u8017\\u7edf\\u8ba1\\uff1acycle\"},\"\\u8d44\\u6e90\\u6d88\\u8017\\u7edf\\u8ba1\\uff1acycle\"),Object(c.b)(\"p\",null,\"\\u63a5\\u53e3\\u65b9\\u6cd5\\u4e2d\\u4f7f\\u7528 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceContext\"),\" \\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn sub_cycles\"),\" \\u63a5\\u53e3\\uff0c\\u53ef\\u4ee5\\u6d88\\u8017\\u4e00\\u5b9a\\u6570\\u91cf\\u7684 cycles \\uff0c\\u63a5\\u53e3\\u5982\\u4e0b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"pub fn sub_cycles(&self, cycles: u64) -> ProtocolResult<()>;\\n\")),Object(c.b)(\"p\",null,\"\\u6b64\\u5916\\uff0c\\u5982\\u679c\\u63a5\\u53e3\\u65b9\\u6cd5\\u6d88\\u8017\\u7684 cycles \\u662f\\u56fa\\u5b9a\\u6570\\u91cf\\uff0c\\u53ef\\u4ee5\\u4f7f\\u7528\\u8fc7\\u7a0b\\u5b8f \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[cycles(amount)]\"),\" \\u6807\\u8bb0\\u63a5\\u53e3\\u65b9\\u6cd5\\uff0c\\u6846\\u67b6\\u4f1a\\u81ea\\u52a8\\u6263\\u9664 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"amount\"),\" \\u6570\\u91cf\\u7684 cycles \\u3002\\u4f8b\\u5982\\uff0c\\u521b\\u5efa\\u8d44\\u4ea7\\u65b9\\u6cd5\\u6d88\\u8017\\u56fa\\u5b9a 210_00 \\u6570\\u91cf\\u7684 cycles: \"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"#[cycles(210_00)]\\n#[write]\\nfn create_asset(&mut self, ctx: ServiceContext, payload: CreateAssetPayload) -> ProtocolResult<Asset>;\\n\")),Object(c.b)(\"h2\",{id:\"\\u4e8b\\u4ef6\"},\"\\u4e8b\\u4ef6\"),Object(c.b)(\"p\",null,\"\\u4f7f\\u7528 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceContext\"),\" \\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn emit_event\"),\" \\u63a5\\u53e3\\uff0c\\u53ef\\u4ee5\\u5411\\u94fe\\u5916\\u629b\\u51fa\\u4e8b\\u4ef6\\u4fe1\\u606f:\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"pub fn emit_event(&self, message: String) -> ProtocolResult<()> ;\\n\")),Object(c.b)(\"p\",null,\"\\u629b\\u51fa\\u7684\\u4e8b\\u4ef6 message \\u4e3a json \\u5e8f\\u5217\\u5316\\u7684\\u5b57\\u7b26\\u4e32\\uff0c\\u4ee5 Asset Service \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"let event = TransferEvent {\\n    asset_id: payload.asset_id,\\n    from: ctx.get_caller(),\\n    to: payload.to,\\n    value: payload.value,\\n};\\nlet event_json = serde_json::to_string(&event).map_err(AssetError::JsonParse)?;\\nctx.emit_event(event_json)\\n\")),Object(c.b)(\"h2\",{id:\"servicecontext-\\u4e2d\\u7684\\u5176\\u4ed6\\u65b9\\u6cd5\"},\"ServiceContext \\u4e2d\\u7684\\u5176\\u4ed6\\u65b9\\u6cd5\"),Object(c.b)(\"p\",null,\"ServiceContext \\u7ef4\\u62a4\\u4ea4\\u6613\\u6267\\u884c\\u7684\\u4e0a\\u4e0b\\u6587\\uff0c\\u901a\\u8fc7 ServiceContext \\u53ef\\u4ee5\\u83b7\\u53d6\\u7684\\u4fe1\\u606f\\u6709\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"// \\u83b7\\u53d6\\u4ea4\\u6613\\u54c8\\u5e0c\\npub fn get_tx_hash(&self) -> Option<Hash>;\\n\\n// \\u83b7\\u53d6 nonce\\npub fn get_nonce(&self) -> Option<Hash>;\\n\\n// \\u83b7\\u53d6 cycle \\u4ef7\\u683c\\npub fn get_cycles_price(&self) -> u64\\uff1b\\n\\n// \\u83b7\\u53d6  cycle limit\\npub fn get_cycles_limit(&self) -> u64\\uff1b\\n\\n// \\u83b7\\u53d6\\u5df2\\u6d88\\u8017 cycles \\u6570\\u91cf\\npub fn get_cycles_used(&self) -> u64\\uff1b\\n\\n// \\u83b7\\u53d6\\u4ea4\\u6613\\u53d1\\u8d77\\u65b9\\u5730\\u5740\\npub fn get_caller(&self) -> Address\\uff1b\\n\\n// \\u83b7\\u53d6\\u4ea4\\u6613\\u6240\\u5728\\u533a\\u5757\\u9ad8\\u5ea6\\npub fn get_current_height(&self) -> u64\\uff1b\\n\\n// \\u83b7\\u53d6\\u989d\\u5916\\u4fe1\\u606f\\npub fn get_extra(&self) -> Option<Bytes>\\uff1b\\n\\n// \\u83b7\\u53d6\\u5f53\\u524d\\u533a\\u5757\\u65f6\\u95f4\\u6233\\npub fn get_timestamp(&self) -> u64\\uff1b\\n\\n// \\u629b\\u51fa\\u4e8b\\u4ef6\\u4fe1\\u606f\\npub fn emit_event(&self, message: String) -> ProtocolResult<()>\\uff1b\\n\")),Object(c.b)(\"h2\",{id:\"service-\\u8c03\\u7528\"},\"Service \\u8c03\\u7528\"),Object(c.b)(\"p\",null,\"\\u901a\\u8fc7 ServiceSDK \\u63d0\\u4f9b \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn write\"),\" \\u548c \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn read\"),\" \\u4e24\\u4e2a\\u65b9\\u6cd5\\uff0c\\u53ef\\u4ee5\\u8c03\\u7528\\u5176\\u4ed6 Service\\u3002\\u524d\\u8005\\u53ef\\u4ee5\\u6539\\u53d8\\u88ab\\u8c03\\u7528 Service \\u7684\\u72b6\\u6001\\uff0c\\u540e\\u8005\\u4e3a\\u53ea\\u8bfb\\u8c03\\u7528\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"pub trait ServiceSDK {\\n    fn read(\\n        &self,\\n        ctx: &ServiceContext,\\n        extra: Option<Bytes>,\\n        service: &str,\\n        method: &str,\\n        payload: &str,\\n    ) -> ProtocolResult<String>;\\n\\n    fn write(\\n        &mut self,\\n        ctx: &ServiceContext,\\n        extra: Option<Bytes>,\\n        service: &str,\\n        method: &str,\\n        payload: &str,\\n    ) -> ProtocolResult<String>;\\n\\n... ...\\n}\\n\")),Object(c.b)(\"p\",null,\"\\u7b2c\\u4e8c\\u4e2a\\u53c2\\u6570 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ServiceContext\"),\" \\u76f4\\u63a5\\u4f20\\u5165\\u81ea\\u8eab\\u7684\\u4e0a\\u4e0b\\u6587\\uff1b\\u7b2c\\u4e09\\u4e2a\\u53c2\\u6570\\u4f20\\u5165\\u8c03\\u7528\\u7684\\u4efb\\u610f\\u9644\\u52a0\\u4fe1\\u606f\\uff1b\\u7b2c\\u56db\\u4e2a\\u53c2\\u6570\\u4e3a\\u88ab\\u8c03 Service \\u7684\\u540d\\u79f0\\uff1b\\u7b2c\\u4e94\\u4e2a\\u53c2\\u6570\\u4e3a\\u8c03\\u7528\\u5176\\u4ed6 Service \\u7684\\u63a5\\u53e3\\u65b9\\u6cd5\\u7684\\u540d\\u79f0\\uff1b\\u7b2c\\u4e94\\u4e2a\\u53c2\\u6570\\u4e3a\\u8c03\\u7528\\u53c2\\u6570 json \\u5e8f\\u5217\\u5316\\u540e\\u7684\\u5b57\\u7b26\\u4e32\\uff1b\"),Object(c.b)(\"h2\",{id:\"hook\"},\"Hook\"),Object(c.b)(\"p\",null,\"\\u6bcf\\u4e2a\\u533a\\u5757\\u6267\\u884c\\u524d\\u540e\\uff0c\\u6846\\u67b6\\u4f1a\\u5206\\u522b\\u8c03\\u7528 Service \\u7684 hook_before\\u3001hook_after \\u65b9\\u6cd5, \\u8fd9\\u4e24\\u4e2a\\u65b9\\u6cd5\\u9700\\u5206\\u522b\\u4f7f\\u7528 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[hook_before]\"),\"\\u3001\",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"#[hook_after]\"),\" \\u8fc7\\u7a0b\\u5b8f\\u6807\\u8bb0\\u3002Service \\u53ef\\u501f\\u52a9 hook \\u529f\\u80fd\\u5b8c\\u6210\\u7279\\u5b9a\\u903b\\u8f91\\uff0c\\u5982 DPoS Service \\u53ef\\u5728 hook_after \\u65b9\\u6cd5\\u4e2d\\u7edf\\u8ba1\\u5019\\u9009\\u9a8c\\u8bc1\\u4eba\\u62b5\\u62bc token \\u6570\\u91cf\\uff0c\\u8fdb\\u884c\\u9a8c\\u8bc1\\u4eba\\u53d8\\u66f4\\u7b49\\u64cd\\u4f5c\\uff1bDex Service \\u53ef\\u5728 hook_after \\u65b9\\u6cd5\\u4e2d\\u5bf9\\u8ba2\\u5355\\u8fdb\\u884c\\u5339\\u914d\\u548c\\u6210\\u4ea4\\u64cd\\u4f5c\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"// Hook method in dex service\\n#[hook_after]\\n    fn deal(&mut self, params: &ExecutorParams) -> ProtocolResult<()>;\\n\")),Object(c.b)(\"h2\",{id:\"\\u5e8f\\u5217\\u5316\"},\"\\u5e8f\\u5217\\u5316\"),Object(c.b)(\"p\",null,\"Service \\u4e3b\\u8981\\u4f7f\\u7528\\u4e24\\u79cd\\u5e8f\\u5217\\u5316\\u65b9\\u6848: Json \\u548c \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/ethereum/wiki/wiki/RLP\"}),\"RLP\"),\";\"),Object(c.b)(\"h3\",{id:\"json\"},\"Json\"),Object(c.b)(\"p\",null,\"\\u7528\\u6237\\u53d1\\u9001\\u4ea4\\u6613\\u548c\\u8fd4\\u56de\\u7ed3\\u679c\\uff0c\\u5747\\u4f7f\\u7528 json \\u5e8f\\u5217\\u5316\\uff0c\\u56e0\\u6b64\\u63a5\\u53e3\\u65b9\\u6cd5\\u7684\\u8f93\\u5165\\u53c2\\u6570\\u4e2d\\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"payload\"),\" \\u548c\\u8fd4\\u56de\\u503c \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"ProtocolResult<Response>\"),\" \\u4e2d\\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"Response\"),\" \\u90fd\\u9700\\u8981\\u5b9e\\u73b0 json \\u5e8f\\u5217\\u5316\\u7684 trait\\u3002\\u4ee5 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/mkxbl/muta-tutorial-dex/tree/master/services/asset\"}),\"Asset Service\"),\" \\u7684 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"fn create_asset\"),\" \\u63a5\\u53e3\\u65b9\\u6cd5\\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"// \\u63a5\\u53e3\\u65b9\\u6cd5\\n#[cycles(210_00)]\\n#[write]\\nfn create_asset(&mut self, ctx: ServiceContext, payload: CreateAssetPayload) -> ProtocolResult<Asset>;\\n\\n// \\u6807\\u8bb0 #[derive(Deserialize, Serialize)] \\u4ee5\\u5b9e\\u73b0 json \\u5e8f\\u5217\\u5316\\n#[derive(Deserialize, Serialize, Clone, Debug)]\\npub struct CreateAssetPayload {\\n    pub name:   String,\\n    pub symbol: String,\\n    pub supply: u64,\\n}\\n// \\u6807\\u8bb0 #[derive(Deserialize, Serialize)] \\u4ee5\\u5b9e\\u73b0 json \\u5e8f\\u5217\\u5316\\n#[derive(Deserialize, Serialize, Clone, Debug)]\\npub struct Asset {\\n    pub id:     Hash,\\n    pub name:   String,\\n    pub symbol: String,\\n    pub supply: u64,\\n    pub issuer: Address,\\n}\\n\")),Object(c.b)(\"p\",null,\"Service \\u4e4b\\u95f4\\u8c03\\u7528\\u7684\\u53c2\\u6570\\u548c\\u8fd4\\u56de\\u503c\\u540c\\u6837\\u4f7f\\u7528 json \\u5e8f\\u5217\\u5316\\uff0c\\u4ee5 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/mkxbl/muta-tutorial-dex/tree/master/services/dex\"}),\"Dex Service\"),\" \\u8c03\\u7528 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/mkxbl/muta-tutorial-dex/tree/master/services/asset\"}),\"Asset Service\"),\" \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),'// \\u5bf9\\u8c03\\u7528\\u53c2\\u6570\\u8fdb\\u884c json \\u5e8f\\u5217\\u5316\\nlet payload_str =\\n    serde_json::to_string(&lock_asset_payload).map_err(DexError::JsonParse)?;\\n\\n// \\u4f7f\\u7528 json \\u5e8f\\u5217\\u5316\\u4e4b\\u540e\\u7684\\u53c2\\u6570\\uff0c\\u8fdb\\u884c service \\u8c03\\u7528\\nself.sdk.write(\\n    &self.get_call_asset_ctx(),\\n    Some(ADMISSION_TOKEN.clone()),\\n    \"asset\",\\n    \"lock\",\\n    &payload_str,\\n)?;\\n')),Object(c.b)(\"h3\",{id:\"rlp\"},\"RLP\"),Object(c.b)(\"p\",null,\"\\u5bf9\\u4e8e\\u5b58\\u50a8\\u5230\\u4e16\\u754c\\u72b6\\u6001\\u7684\\u6570\\u636e\\u7ed3\\u6784\\uff0c\\u4e3a\\u4e86\\u4fdd\\u8bc1\\u5e8f\\u5217\\u5316\\u7684\\u4e00\\u81f4\\u6027\\uff0c\\u8be5\\u6570\\u636e\\u7ed3\\u6784\\u9700\\u8981\\u5b9e\\u73b0 \",Object(c.b)(\"inlineCode\",{parentName:\"p\"},\"trait FixedCodec\"),\"\\uff0c\\u6211\\u4eec\\u9ed8\\u8ba4\\u4f7f\\u7528 RLP \\u65b9\\u6848\\u6765\\u5b9e\\u73b0\\u8be5 trait \\u3002\\u4ee5 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/mkxbl/muta-tutorial-dex/tree/master/services/asset\"}),\"Asset Service\"),\" \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"// Asset \\u9700\\u8981\\u5b58\\u5165\\u4e16\\u754c\\u72b6\\u6001 \\npub struct AssetService<SDK> {\\n    sdk:    SDK,\\n    assets: Box<dyn StoreMap<Hash, Asset>>,\\n}\\n\\npub trait FixedCodec: Sized {\\n    fn encode_fixed(&self) -> ProtocolResult<Bytes>;\\n    fn decode_fixed(bytes: Bytes) -> ProtocolResult<Self>;\\n}\\n\\n// \\u5bf9 Asset \\u5b9e\\u73b0 trait FixedCodec\\nimpl FixedCodec for Asset {\\n    fn encode_fixed(&self) -> ProtocolResult<Bytes> {\\n        Ok(Bytes::from(rlp::encode(self)))\\n    }\\n\\n    fn decode_fixed(bytes: Bytes) -> ProtocolResult<Self> {\\n        Ok(rlp::decode(bytes.as_ref()).map_err(FixedCodecError::from)?)\\n    }\\n}\\n// \\u5bf9 Asset \\u5b9e\\u73b0 RLP \\u53cd\\u5e8f\\u5217\\u5316\\u65b9\\u6848\\nimpl rlp::Decodable for Asset {\\n    fn decode(rlp: &rlp::Rlp) -> Result<Self, rlp::DecoderError> {\\n        Ok(Self {\\n            id:     rlp.at(0)?.as_val()?,\\n            name:   rlp.at(1)?.as_val()?,\\n            symbol: rlp.at(2)?.as_val()?,\\n            supply: rlp.at(3)?.as_val()?,\\n            issuer: rlp.at(4)?.as_val()?,\\n        })\\n    }\\n}\\n// \\u5bf9 Asset \\u5b9e\\u73b0 RLP \\u5e8f\\u5217\\u5316\\u65b9\\u6848\\nimpl rlp::Encodable for Asset {\\n    fn rlp_append(&self, s: &mut rlp::RlpStream) {\\n        s.begin_list(5)\\n            .append(&self.id)\\n            .append(&self.name)\\n            .append(&self.symbol)\\n            .append(&self.supply)\\n            .append(&self.issuer);\\n    }\\n}\\n\")),Object(c.b)(\"h2\",{id:\"\\u6784\\u9020\\u65b9\\u6cd5\"},\"\\u6784\\u9020\\u65b9\\u6cd5\"),Object(c.b)(\"p\",null,\"\\u6784\\u9020\\u65b9\\u6cd5\\u8fd4\\u56de Service \\u5b9e\\u4f8b\\uff0c\\u4ee5 Dex Service \\u4e3a\\u4f8b\\uff1a\"),Object(c.b)(\"pre\",null,Object(c.b)(\"code\",Object(n.a)({parentName:\"pre\"},{className:\"language-rust\"}),\"#[service]\\nimpl<SDK: 'static + ServiceSDK> DexService<SDK> {\\n    pub fn new(mut sdk: SDK) -> ProtocolResult<Self> {\\n        let trades: Box<dyn StoreMap<Hash, Trade>> = sdk.alloc_or_recover_map(TRADES_KEY)?;\\n        let buy_orders: Box<dyn StoreMap<Hash, Order>> =\\n            sdk.alloc_or_recover_map(BUY_ORDERS_KEY)?;\\n        let sell_orders: Box<dyn StoreMap<Hash, Order>> =\\n            sdk.alloc_or_recover_map(SELL_ORDERS_KEY)?;\\n        let history_orders: Box<dyn StoreMap<Hash, Order>> =\\n            sdk.alloc_or_recover_map(HISTORY_ORDERS_KEY)?;\\n        let validity: Box<dyn StoreUint64> = sdk.alloc_or_recover_uint64(VALIDITY_KEY)?;\\n\\n        Ok(Self {\\n            sdk,\\n            trades,\\n            buy_orders,\\n            sell_orders,\\n            history_orders,\\n            validity,\\n        })\\n    }\\n\\n... ...\\n\")),Object(c.b)(\"h2\",{id:\"service-\\u793a\\u4f8b\"},\"Service \\u793a\\u4f8b\"),Object(c.b)(\"p\",null,\"\\u8fd9\\u91cc\\u6709\\u4e00\\u4e2a\\u529f\\u80fd\\u7c7b\\u4f3c ERC-20 \\u7684 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"https://github.com/nervosnetwork/muta/tree/master/built-in-services/asset\"}),\"Asset Service \\u793a\\u4f8b\"),\"\\uff0c\\u8bfb\\u8005\\u53ef\\u4ee5\\u67e5\\u770b\\u4e00\\u4e2a Service \\u7684\\u5168\\u8c8c\\u3002\\u66f4\\u591a\\u7684 Service \\u793a\\u4f8b\\uff0c\\u8bf7\\u53c2\\u8003 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"./service_eg.md\"}),\"Service \\u793a\\u4f8b\"),\"\\u3002\"),Object(c.b)(\"h2\",{id:\"\\u4e0b\\u4e00\\u7ad9\"},\"\\u4e0b\\u4e00\\u7ad9\"),Object(c.b)(\"p\",null,\"\\u73b0\\u5728\\u4f60\\u5df2\\u7ecf\\u5bf9 Service \\u7684\\u7ec4\\u4ef6\\u548c\\u5f00\\u53d1\\u6709\\u4e86\\u4e00\\u5b9a\\u7684\\u8ba4\\u8bc6\\uff0c\\u4e0b\\u4e00\\u6b65\\u901a\\u8fc7\\u5b66\\u4e60 \",Object(c.b)(\"a\",Object(n.a)({parentName:\"p\"},{href:\"/new-docs/docs/dev/dex\"}),\"\\u5f00\\u53d1\\u4e00\\u6761 Dex \\u4e13\\u6709\\u94fe\"),\" \\uff0c\\u4f60\\u5c06\\u5bf9 Service \\u6709\\u4e00\\u4e2a\\u66f4\\u5168\\u9762\\u7684\\u7406\\u89e3\\u5e76\\u4e14\\u5b66\\u4f1a\\u5982\\u4f55\\u4f7f\\u7528 Muta \\u6846\\u67b6\\u5f00\\u53d1\\u81ea\\u5df1\\u7684\\u533a\\u5757\\u94fe\\u3002\"),Object(c.b)(\"blockquote\",null,Object(c.b)(\"p\",{parentName:\"blockquote\"},\"\\u6ce8\\u610f\\uff1a\\u7531\\u4e8e\\u6846\\u67b6\\u6b63\\u5728\\u6301\\u7eed\\u7684\\u5f00\\u53d1\\u8fc7\\u7a0b\\u4e2d\\uff0c\\u6240\\u4ee5\\u6846\\u67b6\\u7684 api \\u6709\\u53ef\\u80fd\\u53d1\\u751f\\u53d8\\u52a8\")))}b.isMDXComponent=!0},206:function(e,t,r){\"use strict\";r.d(t,\"a\",(function(){return p})),r.d(t,\"b\",(function(){return v}));var n=r(0),a=r.n(n);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=a.a.createContext({}),b=function(e){var t=a.a.useContext(s),r=t;return e&&(r=\"function\"==typeof e?e(t):o({},t,{},e)),r},p=function(e){var t=b(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:\"code\",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=Object(n.forwardRef)((function(e,t){var r=e.components,n=e.mdxType,c=e.originalType,l=e.parentName,s=i(e,[\"components\",\"mdxType\",\"originalType\",\"parentName\"]),p=b(r),u=n,v=p[\"\".concat(l,\".\").concat(u)]||p[u]||d[u]||c;return r?a.a.createElement(v,o({ref:t},s,{components:r})):a.a.createElement(v,o({ref:t},s))}));function v(e,t){var r=arguments,n=t&&t.mdxType;if(\"string\"==typeof e||n){var c=r.length,l=new Array(c);l[0]=u;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType=\"string\"==typeof e?e:n,l[1]=o;for(var s=2;s<c;s++)l[s]=r[s];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,r)}u.displayName=\"MDXCreateElement\"}}]);","extractedComments":[]}